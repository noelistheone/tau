2024-07-29 13:51:34,621 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_29_07_2024_13:51:34', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[10, 20, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100, 'func': 0.1, 'func_origin': 1.0, 'cl_rate': 0.25, 'cf_rate': 1.0}
2024-07-29 13:51:35,859 - [INFO] - load train.txt
2024-07-29 13:51:38,578 - [INFO] - building the adj mat ...
2024-07-29 13:51:38,934 - [INFO] - train set len is 810128
2024-07-29 13:51:38,934 - [INFO] - test set len is 217242
2024-07-29 13:51:38,934 - [INFO] - loading over ...
2024-07-29 13:51:38,934 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-07-29 13:51:48,458 - [INFO] - Evaluation Protocols is 1 @ 20
2024-07-29 13:51:48,458 - [INFO] - start training ...
6.425596769544532
2024-07-29 13:51:48,489 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:52:08,943 - [INFO] - E:0|TAU:9.179 9.179, train_time: 18.87, VALID_time: 1.583, loss: 3.091e+03, emb_loss:4.089e-07, best_valid(recall@20): -inf
valid 	 N@10: 0.118, R@10: 0.1126, P@10: 0.06612
valid 	 N@20: 0.1333, R@20: 0.1629, P@20: 0.04809
valid 	 N@50: 0.1626, R@50: 0.2546, P@50: 0.03066

6.425596769544532
2024-07-29 13:52:08,982 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:52:29,544 - [INFO] - E:1|TAU:6.159 24.95, train_time: 18.99, VALID_time: 1.567, loss: 2.885e+03, emb_loss:7.72e-07, best_valid(recall@20): 0.1629
valid 	 N@10: 0.1205, R@10: 0.1104, P@10: 0.06862
valid 	 N@20: 0.1332, R@20: 0.1569, P@20: 0.04933
valid 	 N@50: 0.1592, R@50: 0.2397, P@50: 0.03087

6.425596769544532
2024-07-29 13:52:29,563 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:52:49,721 - [INFO] - E:2|TAU:6.429 22.7, train_time: 18.82, VALID_time: 1.34, loss: 2.714e+03, emb_loss:1.122e-06, best_valid(recall@20): 0.1629
valid 	 N@10: 0.1305, R@10: 0.1213, P@10: 0.07412
valid 	 N@20: 0.1455, R@20: 0.1734, P@20: 0.05362
valid 	 N@50: 0.1752, R@50: 0.2683, P@50: 0.03369

6.425596769544532
2024-07-29 13:52:49,772 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:53:10,241 - [INFO] - E:3|TAU:6.428 24.69, train_time: 18.93, VALID_time: 1.533, loss: 2.691e+03, emb_loss:1.429e-06, best_valid(recall@20): 0.1734
valid 	 N@10: 0.1335, R@10: 0.1245, P@10: 0.07621
valid 	 N@20: 0.1491, R@20: 0.179, P@20: 0.05521
valid 	 N@50: 0.1796, R@50: 0.2759, P@50: 0.0347

6.425596769544532
2024-07-29 13:53:10,288 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:53:31,216 - [INFO] - E:4|TAU:6.42 21.11, train_time: 19.02, VALID_time: 1.908, loss: 2.664e+03, emb_loss:1.738e-06, best_valid(recall@20): 0.179
valid 	 N@10: 0.137, R@10: 0.1275, P@10: 0.0777
valid 	 N@20: 0.1528, R@20: 0.1828, P@20: 0.0562
valid 	 N@50: 0.1837, R@50: 0.2816, P@50: 0.03525

6.425596769544532
2024-07-29 13:53:31,267 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:53:52,021 - [INFO] - E:5|TAU:6.437 19.49, train_time: 19.2, VALID_time: 1.55, loss: 2.652e+03, emb_loss:2.054e-06, best_valid(recall@20): 0.1828
valid 	 N@10: 0.1377, R@10: 0.1282, P@10: 0.07816
valid 	 N@20: 0.1538, R@20: 0.1843, P@20: 0.05667
valid 	 N@50: 0.1851, R@50: 0.2844, P@50: 0.03559

6.425596769544532
2024-07-29 13:53:52,067 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:54:12,451 - [INFO] - E:6|TAU:6.435 18.69, train_time: 18.75, VALID_time: 1.63, loss: 2.641e+03, emb_loss:2.384e-06, best_valid(recall@20): 0.1843
valid 	 N@10: 0.1383, R@10: 0.1286, P@10: 0.07841
valid 	 N@20: 0.1543, R@20: 0.1844, P@20: 0.05673
valid 	 N@50: 0.1859, R@50: 0.2854, P@50: 0.03575

6.425596769544532
2024-07-29 13:54:12,491 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:54:32,936 - [INFO] - E:7|TAU:6.445 18.69, train_time: 18.86, VALID_time: 1.585, loss: 2.634e+03, emb_loss:2.724e-06, best_valid(recall@20): 0.1844
valid 	 N@10: 0.1393, R@10: 0.1295, P@10: 0.07905
valid 	 N@20: 0.1553, R@20: 0.1857, P@20: 0.05711
valid 	 N@50: 0.1869, R@50: 0.2863, P@50: 0.03591

6.425596769544532
2024-07-29 13:54:32,980 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:54:53,547 - [INFO] - E:8|TAU:6.433 18.17, train_time: 18.96, VALID_time: 1.606, loss: 2.627e+03, emb_loss:3.076e-06, best_valid(recall@20): 0.1857
valid 	 N@10: 0.1397, R@10: 0.13, P@10: 0.07938
valid 	 N@20: 0.1561, R@20: 0.1871, P@20: 0.05759
valid 	 N@50: 0.1873, R@50: 0.2867, P@50: 0.03599

6.425596769544532
2024-07-29 13:54:53,587 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:55:13,918 - [INFO] - E:9|TAU:6.433 17.9, train_time: 19.0, VALID_time: 1.334, loss: 2.622e+03, emb_loss:3.442e-06, best_valid(recall@20): 0.1871
valid 	 N@10: 0.1402, R@10: 0.1304, P@10: 0.0795
valid 	 N@20: 0.1566, R@20: 0.1875, P@20: 0.05768
valid 	 N@50: 0.188, R@50: 0.2879, P@50: 0.03612

6.425596769544532
2024-07-29 13:55:13,965 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:55:34,616 - [INFO] - E:10|TAU:6.425 17.93, train_time: 18.99, VALID_time: 1.655, loss: 2.617e+03, emb_loss:3.82e-06, best_valid(recall@20): 0.1875
valid 	 N@10: 0.1407, R@10: 0.1313, P@10: 0.07989
valid 	 N@20: 0.1567, R@20: 0.1874, P@20: 0.05768
valid 	 N@50: 0.1883, R@50: 0.2884, P@50: 0.03616

6.425596769544532
2024-07-29 13:55:34,644 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:55:55,005 - [INFO] - E:11|TAU:6.428 17.51, train_time: 19.11, VALID_time: 1.246, loss: 2.612e+03, emb_loss:4.209e-06, best_valid(recall@20): 0.1875
valid 	 N@10: 0.141, R@10: 0.1313, P@10: 0.07989
valid 	 N@20: 0.1574, R@20: 0.1885, P@20: 0.05796
valid 	 N@50: 0.1889, R@50: 0.2893, P@50: 0.03626

6.425596769544532
2024-07-29 13:55:55,048 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:56:15,792 - [INFO] - E:12|TAU:6.43 17.66, train_time: 18.98, VALID_time: 1.762, loss: 2.608e+03, emb_loss:4.609e-06, best_valid(recall@20): 0.1885
valid 	 N@10: 0.1409, R@10: 0.1315, P@10: 0.08013
valid 	 N@20: 0.1572, R@20: 0.1882, P@20: 0.05797
valid 	 N@50: 0.1886, R@50: 0.289, P@50: 0.03622

6.425596769544532
2024-07-29 13:56:15,813 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:56:36,423 - [INFO] - E:13|TAU:6.418 18.02, train_time: 19.02, VALID_time: 1.585, loss: 2.604e+03, emb_loss:5.021e-06, best_valid(recall@20): 0.1885
valid 	 N@10: 0.1412, R@10: 0.1318, P@10: 0.08027
valid 	 N@20: 0.1573, R@20: 0.1881, P@20: 0.05791
valid 	 N@50: 0.189, R@50: 0.2893, P@50: 0.03629

6.425596769544532
2024-07-29 13:56:36,445 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:56:57,135 - [INFO] - E:14|TAU:6.427 17.39, train_time: 18.99, VALID_time: 1.698, loss: 2.6e+03, emb_loss:5.443e-06, best_valid(recall@20): 0.1885
valid 	 N@10: 0.1417, R@10: 0.1323, P@10: 0.08047
valid 	 N@20: 0.1579, R@20: 0.1891, P@20: 0.05815
valid 	 N@50: 0.1893, R@50: 0.2897, P@50: 0.03634

6.425596769544532
2024-07-29 13:56:57,177 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:57:17,733 - [INFO] - E:15|TAU:6.417 17.29, train_time: 18.9, VALID_time: 1.658, loss: 2.597e+03, emb_loss:5.873e-06, best_valid(recall@20): 0.1891
valid 	 N@10: 0.1415, R@10: 0.1323, P@10: 0.08059
valid 	 N@20: 0.1576, R@20: 0.189, P@20: 0.05817
valid 	 N@50: 0.1892, R@50: 0.29, P@50: 0.03638

6.425596769544532
2024-07-29 13:57:17,758 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:57:38,353 - [INFO] - E:16|TAU:6.426 17.49, train_time: 19.11, VALID_time: 1.486, loss: 2.594e+03, emb_loss:6.312e-06, best_valid(recall@20): 0.1891
valid 	 N@10: 0.1419, R@10: 0.1325, P@10: 0.08064
valid 	 N@20: 0.1582, R@20: 0.1893, P@20: 0.05824
valid 	 N@50: 0.1898, R@50: 0.2906, P@50: 0.03647

6.425596769544532
2024-07-29 13:57:38,398 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:57:58,335 - [INFO] - E:17|TAU:6.413 17.57, train_time: 18.55, VALID_time: 1.388, loss: 2.591e+03, emb_loss:6.759e-06, best_valid(recall@20): 0.1893
valid 	 N@10: 0.1423, R@10: 0.133, P@10: 0.08071
valid 	 N@20: 0.1586, R@20: 0.1901, P@20: 0.05834
valid 	 N@50: 0.1901, R@50: 0.2907, P@50: 0.03647

6.425596769544532
2024-07-29 13:57:58,375 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:58:19,035 - [INFO] - E:18|TAU:6.405 16.84, train_time: 18.98, VALID_time: 1.678, loss: 2.588e+03, emb_loss:7.214e-06, best_valid(recall@20): 0.1901
valid 	 N@10: 0.1421, R@10: 0.1327, P@10: 0.08068
valid 	 N@20: 0.1585, R@20: 0.19, P@20: 0.05835
valid 	 N@50: 0.19, R@50: 0.2907, P@50: 0.03643

6.425596769544532
2024-07-29 13:58:19,063 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:58:39,627 - [INFO] - E:19|TAU:6.414 16.81, train_time: 18.79, VALID_time: 1.77, loss: 2.585e+03, emb_loss:7.674e-06, best_valid(recall@20): 0.1901
valid 	 N@10: 0.1424, R@10: 0.1329, P@10: 0.0808
valid 	 N@20: 0.1589, R@20: 0.1905, P@20: 0.05847
valid 	 N@50: 0.1904, R@50: 0.2912, P@50: 0.03652

6.425596769544532
2024-07-29 13:58:39,689 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:59:00,348 - [INFO] - E:20|TAU:6.419 16.63, train_time: 19.18, VALID_time: 1.48, loss: 2.582e+03, emb_loss:8.142e-06, best_valid(recall@20): 0.1905
valid 	 N@10: 0.1427, R@10: 0.1332, P@10: 0.08098
valid 	 N@20: 0.159, R@20: 0.1902, P@20: 0.05846
valid 	 N@50: 0.1907, R@50: 0.2916, P@50: 0.03656

6.425596769544532
2024-07-29 13:59:00,377 - [INFO] - current w_0 is 9.17942388767301
2024-07-29 13:59:21,123 - [INFO] - E:21|TAU:6.402 16.66, train_time: 19.02, VALID_time: 1.727, loss: 2.579e+03, emb_loss:8.613e-06, best_valid(recall@20): 0.1905
valid 	 N@10: 0.1424, R@10: 0.1331, P@10: 0.08092
valid 	 N@20: 0.1587, R@20: 0.1902, P@20: 0.05846
valid 	 N@50: 0.1904, R@50: 0.2914, P@50: 0.03658

6.425596769544532
2024-07-29 13:59:21,151 - [INFO] - current w_0 is 9.17942388767301
